(function(e){function t(t){for(var a,i,r=t[0],m=t[1],l=t[2],c=0,_=[];c<r.length;c++)i=r[c],n[i]&&_.push(n[i][0]),n[i]=0;for(a in m)Object.prototype.hasOwnProperty.call(m,a)&&(e[a]=m[a]);u&&u(t);while(_.length)_.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,r=1;r<s.length;r++){var m=s[r];0!==n[m]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=s[0]))}return e}var a={},n={app:0},o=[];function i(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=a,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],m=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=m;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},1:function(e,t){},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("f213"),n=s("5f5b"),o=s("8c4f"),i=s("2f62"),r=s("2b0e"),m=(s("f9e3"),s("2dd8"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"main"}},[s("b-container",[s("b-row",{staticClass:"mt-3",attrs:{"align-h":"center"}},[s("b-col",{attrs:{xl:"6"}},[s("b-card",{staticClass:"bg-dark text-white",staticStyle:{"min-height":"500px",height:"500px"}},e._l(this.infdata,function(t,a){return s("b-row",{key:a},[s("b-col",{staticClass:"ins",attrs:{sm:"3"}},[s("strong",[e.author===t.author?s("ins",[e._v(" "+e._s(t.author)+":\n\n                                ")]):s("span",[e._v("                                        "+e._s(t.author)+":\n\n                                ")])])]),s("b-col",{attrs:{sm:"6"}},[e._v(e._s(t.msg))]),s("b-col",{attrs:{sm:"3"}},[s("i",[e._v("\n                            "+e._s(t.date.getHours())+":"+e._s(t.date.getMinutes())+":"+e._s(t.date.getSeconds()))])])],1)}),1)],1)],1),s("b-row",{staticClass:"mt-3",attrs:{"align-h":"center"}},[s("b-col",{attrs:{xl:"5"}},[s("b-input",{model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}})],1),s("b-col",{attrs:{xl:"1"}},[s("b-button",{attrs:{disabled:""===this.now_room,variant:"success"},on:{click:e.send_msg}},[e._v("Send")])],1)],1),s("b-row",{staticClass:"mt-3",attrs:{"align-h":"center"}},[s("b-col",{attrs:{xl:"1"}},[e._v("\n                Nickname:\n            ")]),s("b-col",{attrs:{xl:"4"}},[s("b-input",{staticClass:"bg-dark text-white",model:{value:e.author,callback:function(t){e.author=t},expression:"author"}})],1)],1),s("b-row",{staticClass:"mt-3",attrs:{"align-h":"center"}},e._l(this.rooms,function(t,a){return s("b-col",{key:a,attrs:{xl:"1"}},[s("b-button",{attrs:{variant:t===e.now_room?"primary":"secondary"},on:{click:function(s){return e.join_room(t)}}},[e._v(e._s(t)+"\n                ")])],1)}),1)],1)],1)}),l=[],u=s("8055"),c=s.n(u),_={name:"IndexView",data:()=>({infdata:[],socket:null,msg:"",author:"Author",rooms:[],now_room:"",users:[]}),methods:{init_sock(){this.socket=c.a.connect("http://127.0.0.1:5000"),this.socket.on("msg_client",e=>{e.msg&&(e.date=new Date,this.infdata.push(e))}),this.socket.on("system_event",e=>{this.$snotify.warning(e)}),this.socket.on("room_users",e=>{this.users=e})},send_msg(){this.socket.emit("msg_server",{msg:this.msg,author:this.author,room:this.now_room}),this.msg=""},join_room(e){e!==this.now_room&&(""!==this.now_room&&(this.infdata=[],this.socket.emit("leave_room",{room:this.now_room,user:this.author})),this.socket.emit("join_room",{room:e,user:this.author}),this.now_room=e)}},created(){this.$api.get("/rooms/").then(e=>{this.rooms=e.data}),this.init_sock()}},h=_,g=s("2877"),b=Object(g["a"])(h,m,l,!1,null,"e2fc543a",null),d=b.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"main"}},[s("b-container",[s("b-row",[s("b-col",{attrs:{sm:"5",xl:"2"}},[s("b-input",{attrs:{disabled:e.username_disabled},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("b-col",{attrs:{sm:"3",xl:"3"}},[s("b-button",{attrs:{variant:"success",disabled:e.username_disabled},on:{click:e.save_name}},[e._v("Save name\n                ")])],1)],1),e.start_game_flag?e._e():s("section",[s("b-card",{staticClass:"mt-3"},[null===e.now_game.name?s("section",{staticClass:"mb-3"},[s("b-row",[s("b-col",[e._v("\n                            Create game:\n                        ")])],1),s("b-row",[s("b-col",{attrs:{sm:"5",xl:"2"}},[s("b-input",{model:{value:e.game_name_new,callback:function(t){e.game_name_new=t},expression:"game_name_new"}})],1),s("b-col",{attrs:{sm:"3",xl:"3"}},[s("b-button",{attrs:{variant:"primary",disabled:!e.username_disabled},on:{click:e.post_game}},[e._v("New game\n                            ")])],1)],1)],1):e._e(),s("b-row",[s("b-col",[e._v("\n                        Lobbies:\n                        "),0===e.games.length?s("span",[s("i",[e._v("No lobbies now")])]):e._e()])],1),s("b-row",{staticClass:"mt-3"},e._l(this.games,function(t){return s("b-col",{key:t.name,attrs:{sm:"2"}},[s("b-button",{attrs:{disabled:!e.username_disabled||t.users.length>=2,variant:t.name===e.now_game.name?"primary":"secondary"},on:{click:function(s){return e.join_game(t.name)}}},[e._v("\n                                "+e._s(t.name)+"\n                                ["+e._s(t.users.length)+"/2]\n                            ")])],1)}),1)],1)],1),null!==this.now_game.name?s("section",{staticClass:"mt-3"},[s("hr"),s("b-card",[s("b-row",[s("b-col",{attrs:{xl:"3",sm:"8"}},[s("h3",[e._v("Lobby:\n                            "),s("ins",[e._v(e._s(this.now_game.name))]),e._v("\n                            ["+e._s(this.now_game.users.length)+"/2]\n                        ")])]),s("b-col",[s("b-button",{on:{click:e.leave_game}},[e._v("Leave")])],1)],1),s("b-row",[s("b-col",[e._v("\n                        Players: "),s("i",[e._v(e._s(this.now_game.users.join(", ")))])])],1)],1),this.start_game_flag?s("section",[s("b-row",{staticClass:"mt-3",attrs:{"no-gutters":"","align-h":"start"}},[s("b-col",[s("b-button-group",[s("b-button",{attrs:{variant:"success",disabled:e.now_game_state.turn,size:"lg"},on:{click:function(t){return e.turn("камень")}}},[e._v("Камень\n                            ")]),s("b-button",{attrs:{variant:"warning",disabled:e.now_game_state.turn,size:"lg"},on:{click:function(t){return e.turn("ножницы")}}},[e._v("\n                                Ножницы\n                            ")]),s("b-button",{attrs:{variant:"primary",disabled:e.now_game_state.turn,size:"lg"},on:{click:function(t){return e.turn("бумага")}}},[e._v("Бумага\n                            ")])],1)],1)],1),s("b-row",{staticClass:"mt-3"},[s("b-col",[s("h4",{staticClass:"text-primary"},[e._v("Your: "+e._s(e.now_game_state.value))])])],1),s("b-row",{staticClass:"mt-3"},[s("b-col",[s("h4",[e._v("Opponent's: "+e._s(e.now_game_state.opponent_value))])])],1),s("b-row",{staticClass:"mt-3"},[s("b-col",[s("h3",{class:this.winner===this.username?"text-success":"text-danger"},[e._v("Winner:\n                            "),s("ins",[e._v(e._s(e.winner===e.username?"you":e.winner))])])])],1),s("b-row",{staticClass:"mt-3"},[s("b-col",[e._v("\n                        History: "),e._l(this.history,function(t,a){return s("span",{key:a,class:t===e.username?"text-success":"text-danger"},[e._v(e._s(t)+", ")])})],2)],1),"Ожидаем хода"!==e.winner?s("b-row",[s("b-col",[s("b-button",{attrs:{disabled:e.now_game_state.again_flag},on:{click:e.play_again}},[e._v("Play again\n                            ["+e._s(e.now_game_state.again)+"/2]\n                        ")])],1)],1):e._e()],1):e._e()],1):e._e()],1)],1)},v=[],p={name:"IndexView",data:()=>({games:[],game_name_new:"",now_game:{name:null,users:[]},now_game_state:{turn:!1,value:null,opponent_value:null,again:0,again_flag:!1},history:[],winner:"Ожидаем хода",username:"ChangeYourName",username_disabled:!1,start_game_flag:!1}),methods:{init_sock(){this.socket=c.a.connect("http://127.0.0.1:5000"),this.socket.on("new_game",e=>{this.games.push(e)}),this.socket.on("delete_game",e=>{for(let t=0;t<this.games.length;t++)this.games[t].name===e&&this.$delete(this.games,t)}),this.socket.on("join_user",e=>{for(let t=0;t<this.games.length;t++)if(this.games[t].name===e.game)return this.games[t].users.push(e.user),void(this.games[t].name===this.now_game.name&&(this.now_game.users=this.games[t].users))}),this.socket.on("leave_user",e=>{for(let t=0;t<this.games.length;t++)if(this.games[t].name===e.game)return this.$delete(this.games[t].users,this.games[t].users.indexOf(e.user)),void(this.games[t].name===this.now_game.name&&(this.now_game.users=this.games[t].users))}),this.socket.on("start_game",()=>{this.start_game_flag=!0,this.now_game_state={turn:!1,value:null,opponent_value:null,again:0,again_flag:!1},this.winner="Ожидаем хода"}),this.socket.on("unstart_game",()=>{this.start_game_flag=!1,this.now_game_state={turn:!1,value:null,opponent_value:null},this.winner="Ожидаем хода"}),this.socket.on("end_turn",e=>{this.winner=e.winner,this.history.push(this.winner),this.now_game_state.opponent_value=e.turns[0].user===this.username?e.turns[1].value:e.turns[0].value}),this.socket.on("add_play_again",()=>{this.now_game_state.again++})},save_name(){this.username_disabled=!0,localStorage.name=this.username},post_game(){this.$api.post("/games/",{name:this.game_name_new}).then(e=>{!0===e.data.success?(this.$snotify.success("Success"),this.join_game(this.game_name_new),this.game_name_new=""):this.$snotify.warning("Error")})},join_game(e){this.now_game.name!==e&&(this.socket.emit("join_game",{game:e,username:this.username}),null!==this.now_game.name&&(this.socket.emit("leave_game",{game:this.now_game.name,username:this.username}),this.get_games()),this.history=[],this.now_game.name=e)},leave_game(){this.socket.emit("leave_game",{game:this.now_game.name,username:this.username}),this.now_game={name:null,users:[]},this.now_game_state={turn:!1,value:null,opponent_value:null},this.winner="Ожидаем хода",this.start_game_flag=!1},turn(e){this.socket.emit("turn",{game:this.now_game.name,username:this.username,turn:e}),this.now_game_state.turn=!0,this.now_game_state.value=e},play_again(){this.now_game_state.again_flag=!0,this.socket.emit("play_again",{game:this.now_game.name})},get_games(){this.$api.get("/games/").then(e=>{this.games=e.data.games})},getLS(){localStorage.getItem("name")&&(this.username=localStorage.getItem("name"),this.username_disabled=!0)}},created(){this.getLS(),this.get_games(),this.init_sock()},destroyed(){null!==this.now_game.name&&this.socket.emit("leave_game",{game:this.now_game.name,username:this.username})}},f=p,k=Object(g["a"])(f,w,v,!1,null,"4267a08a",null),y=k.exports;const x=[{path:"/",component:d,name:"indexPage",meta:{}},{path:"/game",component:y,name:"gamePage",meta:{}}];var j=x,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("router-view"),s("vue-snotify")],1)},S=[],O={},$=O,P=(s("5c0b"),Object(g["a"])($,C,S,!1,null,null,null)),L=P.exports;const M=s("bc3a");var E=M.create({baseURL:"/api/v1"});r["default"].use(n["a"]),r["default"].use(o["a"]),r["default"].use(i["a"]),r["default"].use(a["b"],{toast:{position:a["a"].rightTop,timeout:3e3}}),r["default"].prototype.$api=E;const I=new i["a"].Store({state:{},mutations:{}}),N=new o["a"]({routes:j,mode:"history",scrollBehavior:()=>({y:0})});new r["default"]({el:"#app",router:N,store:I,render:e=>e(L)})},"5c0b":function(e,t,s){"use strict";var a=s("5e27"),n=s.n(a);n.a},"5e27":function(e,t,s){}});